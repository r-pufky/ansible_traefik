---
###############################################################################
# Traefik Service Configuration
###############################################################################
# WARNING
# > Traefik runs as root to access privileged ports. Run in isolated container
# > with no additional privileges or mounts. Service hardened with systemd.
#
# Install size: ~161MB
#      traefik: ~161MB.
#
# Set repo_host_access_token if API is rate limited. See r_pufky.deb.repo.

# Traefik Release.
#
# Versions (Schematic):
#       MAJOR: Safe - Usually requires no role updates.
#       MINOR: Safe - Usually requires no role updates.
#       PATCH: Safe - Usually requires no role updates.
#   RECOMMEND: Always check release notes when upgrading versions - custom
#              configuration files may break though role will likely not. Never
#              use 'latest'.
#
# Values:
#   {VERSION}: Tagged release to use ('v3.5.6', 'v3.6.2').
#      latest: Use latest stable release.
#
# Default: 'v3.5.6'.
#
# Reference:
# * https://doc.traefik.io/traefik/deprecation/releases
traefik_srv_version: 'v3.5.6'

# Traefik Environment.
#
# Set environment variables for Traefik service. Especially useful for setting
# lego configuration for let's encrypt certificates on bare metal.
#
# traefik_srv_env:
#     list of dict - Environment variables to set.
#   - var: str - Environment variable name.
#     value: str - Environment variable value.
#
# traefik_srv_env:
#   - var: 'GCE_PROJECT'
#     value: 'my-project-id-123456789'
#   - var: 'GCE_SERVICE_ACCOUNT_FILE'
#     value: '/etc/traefik/gcloud_dns.json'  # Use traefik_srv_cfg_dir.
#
# Default: [] (disabled).
traefik_srv_env: []

# Traefik Configuration.
#
# Special Case:
# * traefik.{toml,yml} startup configuration automatically selected for systemd
#   service. YAML is used if both exist.
# * Traefik daemon restricted to read/write on /var/lib/traefik. Place state
#   (e.g. ACME certificate state) data here in settings.
# * Service credential files should be placed here.
# * Vault encrypted files will automatically be decrypted on remote.
# * Template files may be used (without template extension).
#
# Sourced from ansible controller; automatically placed in
# /etc/traefik/ with correct permissions.
#
# traefik_cfg_tls_cert: 'host_vars/db.example.com/data/traefik'
#
# Default: '' (disabled).
traefik_srv_cfg_dir: ''

# Enable service restart?
#
# Traefik only needs to be restarted for startup configuration changes.
#
# Values:
#    True: Traefik is 'restarted' after role configuration is completed. May
#          lead to service interruptions - startup configuration reloaded.
#   False: Traefik is 'started' after role configuration is completed - startup
#          configuration changes will NOT be picked up.
#
# Default: True.
traefik_srv_restart_enable: true

# Remove old installs on upgrade success? Default: True.
traefik_srv_delete_old_versions_enable: true

# Force overwrite existing install?
#
# DATA DESTRUCTIVE.
#
# Removes existing cached downloaded archives and existing same-version install
# directories (if any). Any user data in these directories are DESTROYED.
#
# Default: False.
traefik_srv_force_overwrite: false

# Only apply configuration?
#
# Reduces role application time by ONLY applying configuration changes.
#
# This should ONLY be used after the role has been fully run once.
#
# Useful when adding a change without reconfiguring the whole system or
# checking and installing a new version. Suggest applying with extra options:
#
#   ansible-playbook site.yml
#       --tags Traefik
#       -e '{"traefik_srv_force_config_only_enable": true}'
#
# Default: False.
traefik_srv_force_config_only_enable: false

###############################################################################
# Traefik User
###############################################################################

# Enable running service as traefik_srv_user?
#
# Values:
#    True: Enable user - service will be created with CAP_NET_BIND_SERVICE
#          capabilities to allow binding on ports <1024.
#   False: Disable user (run as root) - Not recommended. Run in isolated
#          VM or container; always try enabling first.
#
# Default: True.
traefik_srv_user_enable: true

# User that Traefik will run under.
#
# Enable traefik_srv_create_user if this account is not externally managed.
#
# Default: 'traefik'.
traefik_srv_user: 'traefik'

# Group that Traefik will run under.
#
# Enable traefik_srv_create_user if this group is not externally managed.
#
# Default: 'traefik'.
traefik_srv_group: 'traefik'

# Create traefik_srv_user, traefik_srv_group if not detected?
#
# Applied via r_pufky.deb.users, see vars/main.yml for default user attributes.
#
# Default: True.
traefik_srv_create_user: true
